# Интеграция между ботами на платформе JAICP и help-desk платформой Usedesk

## Описание
На текущий момент интеграция реализует:
1. Передачу в JAICP текстовых сообщений и файлов, полученных из каналов Usedesk
2. Перевод на оператора
3. Создание собственных обработчиков событий из Usedesk

Обработка триггеров пока не реализована.
Полученные и отправленный запросы, а также ошибки фиксируются в папке logs в соотвествующих подпапках.

 ## Установка
 1. Скачайте репозиторий `git clone https://github.com/sedalit/jaicp-usedesk-integration.git`
 2. Выполните команды:
```
composer install
php install
```
3. Подключите к боту канал Chat API.
4. Создайте в Usedesk новый API канал, в качестве "Redirect url" укажите ссылку на файл index.php в корне репозитория.
5. Создайте в Usedesk агента для бота и группу агентов, в которой будет состоять бот.
6. Настройте файл config.json в корне репозитория.

### Пример файла config.json

```
{
    "tokens" : {
        "chatApiToken": "Токен из настроек канала Chat API в JAICP",
        "usedeskApiToken": "Токен из настроек API канала в Usedesk"
    },
    "usedesk": {
        "botUserId": "ID агента, на котором будет работать бот",
        "botGroupId": "ID группы агентов, в которой состоит бот",
        "dialogClosedStatus": "2",
        "platforms": {
            "ID мессенджера в Usedesk": "Название мессенджера для передачи в аналитику бота"
        },
        "channels": {
            "ID канала в Usedesk": "Название канала для передачи в аналитику бота"
        },
        "operatorGroups": {
            "defaultOperatorGroupID": "64608",
            "Название канала из Usedesk": "ID операторской группы, на которую бот должен переводить тикеты из канала с указанным названием"
        }
    },
    "jaicp": {
        "host": "zb04.just-ai.com"
    }
}
```
